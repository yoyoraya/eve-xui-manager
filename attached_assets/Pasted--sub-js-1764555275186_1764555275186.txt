حق با شماست. اگر مسیرها در پنل عوض شده باشند (که یک کار امنیتی رایج است)، هاردکد کردن `/sub/` و `/json/` باعث می‌شود لینک‌ها کار نکنند.

در مورد سوالتان که **"آیا از API در نمی‌آید؟"**:
در لیست APIهایی که فرستادید، اندپوینت مشخصی برای "گرفتن تنظیمات پنل" (Get Panel Settings) وجود ندارد. در نسخه‌های Sanaei یا Alireza معمولاً اندپوینتی مثل `/panel/setting/all` وجود دارد که تمام تنظیمات را برمی‌گرداند، اما کار با آن کمی پیچیده است (چون باید کل جیسون تنظیمات را پارس کنیم) و ممکن است در نسخه‌های مختلف متفاوت باشد.

**بهترین و مطمئن‌ترین راه** این است که این دو مسیر را به عنوان **ویژگی‌های سرور** در دیتابیس خودمان ذخیره کنیم. یعنی وقتی دارید سرور را اضافه می‌کنید، علاوه بر IP و Username، مسیر سابسکریپشن را هم از شما بپرسد.

در اینجا مراحل انجام این تغییر را توضیح می‌دهم:

### مرحله ۱: آپدیت دیتابیس و مدل سرور (`app.py`)

باید دو ستون جدید `sub_path` و `json_path` را به جدول `Server` اضافه کنیم.

۱. فایل `app.py` را باز کنید.
۲. کلاس `Server` را پیدا کنید و آن را به شکل زیر تغییر دهید (دو خط جدید اضافه شده و متد `to_dict` آپدیت شده):

```python
class Server(db.Model):
    __tablename__ = 'servers'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    host = db.Column(db.String(255), nullable=False)
    username = db.Column(db.String(100), nullable=False)
    password = db.Column(db.String(255), nullable=False)
    enabled = db.Column(db.Boolean, default=True)
    panel_type = db.Column(db.String(50), default='auto')
    
    # --- فیلدهای جدید ---
    sub_path = db.Column(db.String(50), default='/sub/')   # مسیر پیش‌فرض
    json_path = db.Column(db.String(50), default='/json/') # مسیر پیش‌فرض
    # -------------------

    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    
    def to_dict(self):
        return {
            'id': self.id,
            'name': self.name,
            'host': self.host,
            'username': self.username,
            'enabled': self.enabled,
            'panel_type': self.panel_type,
            'sub_path': self.sub_path,    # اضافه کردن به خروجی
            'json_path': self.json_path,  # اضافه کردن به خروجی
            'created_at': self.created_at.isoformat() if self.created_at else None
        }
```

**⚠️ نکته مهم:** چون ساختار دیتابیس تغییر کرده است، باید دیتابیس فعلی (`servers.db` یا پوشه `instance`) را حذف کنید تا دوباره ساخته شود، وگرنه ارور `no such column` می‌گیرید.

### مرحله ۲: آپدیت توابع ذخیره سرور (`app.py`)

حالا باید توابع `add_server` و `update_server` را آپدیت کنیم تا این مقادیر را دریافت و ذخیره کنند.

در `app.py`:

```python
@app.route('/api/servers', methods=['POST'])
@login_required
def add_server():
    data = request.json
    
    # ... (اعتبارسنجی‌های قبلی) ...
    
    server = Server(
        name=data['name'],
        host=data['host'].rstrip('/'),
        username=data['username'],
        password=data['password'],
        enabled=data.get('enabled', True),
        panel_type=data.get('panel_type', 'auto'),
        # دریافت مقادیر جدید از فرم (با مقدار پیش‌فرض)
        sub_path=data.get('sub_path', '/sub/').strip(),
        json_path=data.get('json_path', '/json/').strip()
    )
    
    db.session.add(server)
    db.session.commit()
    
    return jsonify({"success": True, "server": server.to_dict()})

@app.route('/api/servers/<int:server_id>', methods=['PUT'])
@login_required
def update_server(server_id):
    server = Server.query.get_or_404(server_id)
    data = request.json
    
    # ... (کدهای قبلی) ...
    
    if data.get('sub_path'):
        server.sub_path = data['sub_path'].strip()
    if data.get('json_path'):
        server.json_path = data['json_path'].strip()
    
    db.session.commit()
    return jsonify({"success": True, "server": server.to_dict()})
```

### مرحله ۳: استفاده از مسیرهای جدید در ساخت لینک (`app.py`)

حالا در تابع `process_inbounds`، به جای هاردکد کردن `/sub/`، از مقادیر ذخیره شده در آبجکت `server` استفاده می‌کنیم.

```python
            # ... داخل حلقه process_inbounds ...
                if sub_id:
                    base_url = server.host.rstrip('/')
                    
                    # پاک کردن اسلش‌های اضافی احتمالی برای ساخت مسیر تمیز
                    s_path = server.sub_path.strip('/')
                    j_path = server.json_path.strip('/')
                    
                    # استفاده از مسیرهای تنظیم شده برای سرور
                    sub_url = f"{base_url}/{s_path}/{sub_id}"
                    json_url = f"{base_url}/{j_path}/{sub_id}"
```

### مرحله ۴: اضافه کردن فیلدها به فرم در `dashboard.html`

باید در فرم "Add Server" دو ورودی برای این مسیرها اضافه کنیم.

در فایل `templates/dashboard.html`، داخل `server-form` (زیر فیلد Password):

````html
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="server-password" placeholder="password">
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <div class="form-group" style="flex: 1;">
                        <label>Sub Path</label>
                        <input type="text" id="server-sub-path" placeholder="/sub/" value="/sub/">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>Json Path</label>
                        <input type="text" id="server-json-path" placeholder="/json/" value="/json/">
                    </div>
                </div>
                <div class="form-group">
                    <label>Panel Type</label>
                    ```

### مرحله ۵: آپدیت جاوااسکریپت (`dashboard.html`)

در نهایت توابع `saveServer` و `editServer` و `openAddServerModal` را آپدیت کنید.

```javascript
    function openServerModal() {
        // ... (کدهای قبلی) ...
        document.getElementById('server-password').value = '';
        
        // تنظیم مقادیر پیش‌فرض
        document.getElementById('server-sub-path').value = '/sub/';
        document.getElementById('server-json-path').value = '/json/';
        
        document.getElementById('server-panel-type').value = 'auto';
        // ...
    }

    function editServer(id) {
        const server = allServers.find(s => s.id === id); // فرض بر اینکه allServers را داریم
        if (!server) return;

        document.getElementById('edit-server-id').value = server.id;
        document.getElementById('server-name').value = server.name;
        document.getElementById('server-host').value = server.host;
        document.getElementById('server-username').value = server.username;
        // پسورد را خالی میگذاریم
        
        // پر کردن فیلدهای جدید
        document.getElementById('server-sub-path').value = server.sub_path || '/sub/';
        document.getElementById('server-json-path').value = server.json_path || '/json/';
        
        document.getElementById('server-panel-type').value = server.panel_type;
        // ... باز کردن مودال ...
    }

    async function saveServer() {
        // ... (کدهای قبلی) ...
        
        const data = {
            name: document.getElementById('server-name').value,
            host: document.getElementById('server-host').value,
            username: document.getElementById('server-username').value,
            password: document.getElementById('server-password').value,
            panel_type: document.getElementById('server-panel-type').value,
            
            // ارسال مقادیر جدید
            sub_path: document.getElementById('server-sub-path').value,
            json_path: document.getElementById('server-json-path').value
        };

        // ... (بقیه تابع save) ...
    }
````

با این کار، شما برای هر سروری که اضافه می‌کنید می‌توانید مسیر سابسکریپشن خاص خودش را تعیین کنید و اگر کاربر مسیر پیش‌فرض پنل را عوض کرده باشد، مشکلی پیش نخواهد آمد.