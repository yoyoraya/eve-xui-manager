<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscription - {{ client.email }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              background: '#0B1121',
              surface: '#151e32',
              primary: '#6366f1',
              secondary: '#10b981',
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #0B1121;
        color: #e2e8f0;
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #0B1121;
      }
      ::-webkit-scrollbar-thumb {
        background: #334155;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #475569;
      }
      .tab-btn {
        @apply px-4 py-2 rounded-lg font-medium text-sm transition-all cursor-pointer;
      }
      .tab-btn.inactive {
        @apply text-slate-400 hover:text-slate-300 hover:bg-slate-800/50;
      }
      .tab-btn.active {
        @apply bg-primary text-white shadow-lg shadow-primary/50;
      }
      .success-toast {
        @apply fixed bottom-4 right-4 bg-secondary text-white px-6 py-3 rounded-lg shadow-lg;
      }
    </style>
</head>
<body class="bg-background">
    <div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
        <!-- Background gradient overlay -->
        <div class="fixed inset-0 -z-10 opacity-30">
            <div class="absolute inset-0 bg-gradient-to-br from-primary/20 via-background to-secondary/10"></div>
        </div>

        <div class="max-w-3xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">
                    {{ client.email }}
                </h1>
                <div class="flex justify-center gap-3 mt-4">
                    <span class="inline-block px-4 py-1 rounded-full text-sm font-semibold {% if client.is_active %}bg-secondary/20 text-secondary{% else %}bg-red-500/20 text-red-400{% endif %}">
                        {% if client.is_active %}‚úì Active{% else %}‚úó Inactive{% endif %}
                    </span>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <!-- Usage -->
                <div class="bg-surface rounded-xl border border-slate-700/50 p-4 hover:border-primary/50 transition-all">
                    <div class="text-slate-400 text-sm font-medium mb-1">Used</div>
                    <div class="text-2xl font-bold text-primary">{{ client.total_used }}</div>
                </div>
                <!-- Limit -->
                <div class="bg-surface rounded-xl border border-slate-700/50 p-4 hover:border-primary/50 transition-all">
                    <div class="text-slate-400 text-sm font-medium mb-1">Limit</div>
                    <div class="text-2xl font-bold text-slate-200">{{ client.total_limit }}</div>
                </div>
                <!-- Download -->
                <div class="bg-surface rounded-xl border border-slate-700/50 p-4 hover:border-primary/50 transition-all">
                    <div class="text-slate-400 text-sm font-medium mb-1">‚Üì Download</div>
                    <div class="text-2xl font-bold text-blue-400">{{ client.download }}</div>
                </div>
                <!-- Upload -->
                <div class="bg-surface rounded-xl border border-slate-700/50 p-4 hover:border-primary/50 transition-all">
                    <div class="text-slate-400 text-sm font-medium mb-1">‚Üë Upload</div>
                    <div class="text-2xl font-bold text-cyan-400">{{ client.upload }}</div>
                </div>
            </div>

            <!-- Progress Bar -->
            {% if client.percentage_used >= 0 %}
            <div class="mb-8">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-slate-400 text-sm">Data Usage Progress</span>
                    <span class="text-primary font-semibold">{{ "{:.1f}".format(client.percentage_used) }}%</span>
                </div>
                <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-primary to-secondary rounded-full transition-all duration-500" style="width: {{ [client.percentage_used, 100]|min }}%"></div>
                </div>
            </div>
            {% endif %}

            <!-- Info Row -->
            <div class="bg-surface rounded-xl border border-slate-700/50 p-4 mb-8">
                <div class="flex justify-between items-center">
                    <span class="text-slate-400">‚è∞ Expires In</span>
                    <span class="font-semibold text-slate-200">{{ client.expiry }}</span>
                </div>
            </div>

            <!-- Subscription Section -->
            <div class="bg-surface rounded-xl border border-slate-700/50 p-6 mb-8">
                <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                    <span>üì•</span> Import Subscription
                </h2>
                
                <div id="successMsg" class="success-toast opacity-0 pointer-events-none transition-opacity">
                    ‚úì Copied to clipboard!
                </div>

                <!-- Copy Box -->
                <div class="mb-6">
                    <label class="text-slate-400 text-sm font-medium mb-2 block">Subscription Link</label>
                    <div class="flex gap-2">
                        <input 
                            type="text" 
                            id="subLink" 
                            value="{{ client.subscription_url }}" 
                            readonly 
                            class="flex-1 bg-background border border-slate-600 rounded-lg px-4 py-2 text-slate-300 font-mono text-sm focus:border-primary focus:outline-none transition-colors"
                        >
                        <button onclick="copyLink('subLink')" class="px-4 py-2 bg-primary hover:bg-primary/80 text-white font-medium rounded-lg transition-all">
                            Copy
                        </button>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="mb-6">
                    <div class="flex gap-2 mb-6 overflow-x-auto pb-2">
                        <button class="tab-btn active" onclick="switchTab(event, 'v2ray')">üì± v2rayNG</button>
                        <button class="tab-btn inactive" onclick="switchTab(event, 'nekobox')">üì¶ NekoBox</button>
                        <button class="tab-btn inactive" onclick="switchTab(event, 'streisand')">üîê Streisand</button>
                        <button class="tab-btn inactive" onclick="switchTab(event, 'others')">üåê Others</button>
                    </div>

                    <!-- v2rayNG -->
                    <div id="v2ray" class="tab-content">
                        <div class="bg-background/50 rounded-lg p-4 mb-4 border-l-4 border-primary">
                            <h3 class="font-semibold text-slate-200 mb-3">Setup Steps</h3>
                            <ol class="text-slate-400 text-sm space-y-2 list-decimal list-inside">
                                <li>Download v2rayNG from Google Play or APK sources</li>
                                <li>Open the app ‚Üí Tap "+" menu</li>
                                <li>Select "Subscription" or "Import from clipboard"</li>
                                <li>Paste the subscription link above</li>
                                <li>Tap connect and enjoy!</li>
                            </ol>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <a href="https://play.google.com/store/apps/details?id=com.v2ray.ang" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>üì≤</span> Google Play
                            </a>
                            <a href="https://github.com/2dust/v2rayNG/releases" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>‚¨áÔ∏è</span> APK
                            </a>
                        </div>
                    </div>

                    <!-- NekoBox -->
                    <div id="nekobox" class="tab-content hidden">
                        <div class="bg-background/50 rounded-lg p-4 mb-4 border-l-4 border-primary">
                            <h3 class="font-semibold text-slate-200 mb-3">Setup Steps</h3>
                            <ol class="text-slate-400 text-sm space-y-2 list-decimal list-inside">
                                <li>Download NekoBox from GitHub Releases</li>
                                <li>Open the app ‚Üí Go to Profiles</li>
                                <li>Tap "+" ‚Üí "Add Profile from Clipboard"</li>
                                <li>Paste the subscription link and save</li>
                                <li>Select profile and connect!</li>
                            </ol>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <a href="https://github.com/MatsuriDayo/NekoBoxForAndroid/releases" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>‚¨áÔ∏è</span> APK
                            </a>
                            <a href="https://play.google.com/store/apps/details?id=moe.nb4a" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>üì≤</span> Play Store
                            </a>
                        </div>
                    </div>

                    <!-- Streisand -->
                    <div id="streisand" class="tab-content hidden">
                        <div class="bg-background/50 rounded-lg p-4 mb-4 border-l-4 border-primary">
                            <h3 class="font-semibold text-slate-200 mb-3">Setup Steps</h3>
                            <ol class="text-slate-400 text-sm space-y-2 list-decimal list-inside">
                                <li>Download Streisand for iOS from App Store</li>
                                <li>Open the app ‚Üí Tap "+" button</li>
                                <li>Choose "Add from Clipboard"</li>
                                <li>Paste your subscription link</li>
                                <li>Save and connect!</li>
                            </ol>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <a href="https://apps.apple.com/us/app/streisand/id6450534064" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>üçé</span> App Store
                            </a>
                        </div>
                    </div>

                    <!-- Others -->
                    <div id="others" class="tab-content hidden">
                        <div class="bg-background/50 rounded-lg p-4 mb-4 border-l-4 border-primary">
                            <h3 class="font-semibold text-slate-200 mb-3">Popular Apps</h3>
                            <ul class="text-slate-400 text-sm space-y-2 list-disc list-inside">
                                <li><strong class="text-slate-300">Shadowrocket (iOS):</strong> App ‚Üí "+" ‚Üí Import ‚Üí Paste</li>
                                <li><strong class="text-slate-300">Clash (Android):</strong> Profile ‚Üí Add from clipboard</li>
                                <li><strong class="text-slate-300">Sing-Box:</strong> Configuration ‚Üí Add subscription</li>
                                <li><strong class="text-slate-300">Hiddify:</strong> Profiles ‚Üí Add ‚Üí Paste link</li>
                            </ul>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <a href="https://apps.apple.com/us/app/shadowrocket/id932747118" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>üçé</span> Shadowrocket
                            </a>
                            <a href="https://github.com/SagerNet/sing-box" target="_blank" class="px-4 py-2 bg-primary/20 text-primary hover:bg-primary/30 border border-primary/50 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2">
                                <span>‚¨áÔ∏è</span> Sing-Box
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manual Configs -->
            {% if client.configs %}
            <div class="bg-surface rounded-xl border border-slate-700/50 p-6">
                <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                    <span>‚öôÔ∏è</span> Manual Configs
                </h2>
                <div class="space-y-2">
                    {% for config in client.configs %}
                    <div class="bg-background/50 border border-slate-600/50 rounded-lg p-3 hover:border-primary/50 cursor-pointer transition-all font-mono text-xs text-slate-400 hover:text-slate-300 break-all" onclick="copyConfig(this, '{{ config }}')">
                        {{ config[:100] }}{% if config|length > 100 %}...{% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Footer -->
            <div class="text-center mt-12 text-slate-500 text-sm">
                <p>Eve - Xui Manager</p>
            </div>
        </div>
    </div>

    <script>
        function switchTab(e, tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('active');
                el.classList.add('inactive');
            });
            
            document.getElementById(tabName).classList.remove('hidden');
            e.target.classList.add('active');
            e.target.classList.remove('inactive');
        }

        function copyToClipboard(text) {
            if (!text) return;
            navigator.clipboard.writeText(text).then(() => {
                showSuccess();
            }).catch(() => {
                alert('Failed to copy');
            });
        }

        function copyLink(elementId) {
            const element = document.getElementById(elementId);
            copyToClipboard(element.value);
        }

        function copyConfig(element, config) {
            copyToClipboard(config);
            element.style.background = 'rgba(16, 185, 129, 0.2)';
            element.style.borderColor = 'rgba(16, 185, 129, 0.5)';
            setTimeout(() => {
                element.style.background = '';
                element.style.borderColor = '';
            }, 500);
        }

        function showSuccess() {
            const msg = document.getElementById('successMsg');
            msg.classList.remove('opacity-0', 'pointer-events-none');
            setTimeout(() => {
                msg.classList.add('opacity-0', 'pointer-events-none');
            }, 2000);
        }

        document.getElementById('subLink').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') copyLink('subLink');
        });
    </script>
</body>
</html>
